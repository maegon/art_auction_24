<html layout:decorate="~{layout/layout}">
<div layout:fragment="content">
    <div class="admContainer">
        <div class="mg_container mt-3 mb-3">
            <div class="mg_menu_mb_container flex-col">
                <div class="mg_menu_section flex justify-between">
                    <span class="text-xl mt-2 mb-1 text-3xl">회원 권한 설정</span>
                    
                    <!-- 검색란 -->
                    <div class="search-container mt-2 mb-1">
                        <input type="text" name="kw" id="memberSearch" placeholder="회원 검색" class="search-input w-full">
                    </div>
                </div>
                
                
                <!-- 메뉴 -->
                <div class="mg_mb_menu flex mt-3 mr-3">
                    <ul class="flex flex-wrap justify-between space-x-2 w-full font-semibold text-xl">
                        <li class="mb_un flex-1 text-center">아이디</li>
                        <li class="mb_nm flex-1 text-center">닉네임</li>
                        <li class="mb_e flex-1 text-center">이메일</li>
                        <li class="mb_cd flex-1 text-center">생성 날짜</li>
                        <li class="mb_md flex-1 text-center">수정 날짜</li>
                        <li class="mb_pi flex-1 text-center">프로필사진</li>
                        <li class="mb_pnb flex-1 text-center">전화번호</li>
                        <li class="mb_ad flex-1 text-center">주소</li>
                        <li class="mb_ia flex-1 text-center">활성 여부</li>
                        <li class="mb_ptc flex-1 text-center">소셜로그인</li>
                        <li class="mb_rl flex-1 text-center">권한</li>
                        <li class="mb_ac flex-1 text-center"></li>
                    </ul>
                </div>
                
                
                <!-- 목록 -->
                <div class="mb_mb_list">
                    <ul>
                        <li th:each="member : ${memberList}" class="mb_list_each flex flex-wrap justify-between space-x-2 flex-1 text-center">
                            <div class="mb_list_un mb_un flex-1 overflow-hidden content-center" th:text="${member.username}"></div>
                            <div class="mb_list_nm mb_nm flex-1 overflow-hidden content-center" th:text="${member.nickname}"></div>
                            <div class="mb_list_e mb_e flex-1 overflow-hidden content-center" th:text="${member.email}"></div>
                            <div class="mb_list_cd mb_cd flex-1 overflow-hidden content-center" th:text="${#temporals.format(member.createDate, 'yyyy년 MM월 dd일 HH:mm')}"></div>
                            <div class="mb_list_md mb_md flex-1 overflow-hidden content-center" th:text="${#temporals.format(member.modifyDate, 'yyyy년 MM월 dd일 HH:mm')}"></div>
                            <div class="mb_list_pi mb_pi flex-1 content-center">
                                <img th:src="@{${member.image}}" alt="프로필 이미지"/>
                            </div>
                            <div class="mb_list_pnb mb_pnb flex-1 overflow-hidden content-center" th:text="${member.phoneNumber}"></div>
                            <div class="mb_list_ad mb_ad flex-1 overflow-hidden content-center" th:text="${member.address}"></div>
                            <div class="mb_list_ia mb_ia flex-1 content-center">
                                <select th:value="${member.isActive}" class="isActive">
                                    <option value="true" th:selected="${member.isActive}">활성</option>
                                    <option value="false" th:selected="!${member.isActive}">비활성</option>
                                </select>
                            </div>
                            <div class="mb_list_ptc mb_ptc flex-1 content-center" th:text="${member.providerTypeCode}"></div>
                            <div class="mb_list_rl mb_rl flex-1 content-center">
                                <select th:value="${member.role}" class="role">
                                    <option value="USER" th:selected="${member.role == 'USER'}">일반</option>
                                    <option value="ARTIST" th:selected="${member.role == 'ARTIST'}">작가</option>
                                    <option value="ADMIN" th:selected="${member.role == 'ADMIN'}">관리자</option>
                                </select>
                            </div>
                            <div class="mb_action mb_ac flex-1 content-center">
                                <button type="button" class="btn_save" data-memberid="${member.id}">저장</button>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <!-- 알림 메시지를 표시할 요소 -->
        <div id="copyAlert" class="alert hidden">텍스트가 복사되었습니다!</div>
    </div>
</div>
</html>
<script th:src="@{/js/admin/member/list.js}"></script>
<script>
    // 텍스트를 클립보드에 복사하는 함수
    function copyTextToClipboard(text) {
        // Clipboard API를 사용하여 텍스트를 복사합니다
        navigator.clipboard.writeText(text).then(() => {
            showAlert('텍스트가 복사되었습니다!');
        }).catch(err => {
            console.error('텍스트 복사 중 오류 발생: ', err);
        });
    }

    // 알림 메시지를 표시하는 함수
    function showAlert(message) {
        const alertBox = document.getElementById('copyAlert');
        alertBox.textContent = message;
        alertBox.classList.remove('hidden');
        alertBox.classList.add('show');

        // 3초 후에 알림을 숨깁니다
        setTimeout(() => {
            alertBox.classList.remove('show');
            alertBox.classList.add('hidden');
        }, 3000);
    }

    // 각 div에 대해 더블 클릭 이벤트 리스너를 추가하여 텍스트를 복사합니다
    document.addEventListener('DOMContentLoaded', function() {
        const listItems = document.querySelectorAll('.mb_mb_list ul li div');

        listItems.forEach(item => {
            item.addEventListener('dblclick', function() {
                const textToCopy = item.textContent.trim();
                copyTextToClipboard(textToCopy);
            });
        });
    });
</script>